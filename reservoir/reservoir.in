SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE TH
    /
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
    /
  /
END

SUBSURFACE

#=========================== numerical methods ================================
NUMERICAL_METHODS FLOW
  LINEAR_SOLVER
    SOLVER ITERATIVE
  /
END
 
NUMERICAL_METHODS TRANSPORT
  LINEAR_SOLVER
    SOLVER ITERATIVE
  /
END
 
#=========================== discretization ===================================
GRID
  TYPE STRUCTURED CYLINDRICAL
  NXYZ 400 1 80
  ORIGIN 0.1 0. 0.
  DXYZ
    3.0985542e-03 3.19456458e-03 3.29354989e-03 3.39560232e-03 3.5008169e-03 \
    3.60929161e-03 3.72112746e-03 3.83642861e-03 3.95530243e-03 4.07785962e-03 \
    4.20421431e-03 4.33448417e-03 4.46879051e-03 4.60725841e-03 4.75001681e-03 \
    4.89719865e-03 5.04894101e-03 5.20538518e-03 5.36667686e-03 5.53296625e-03 \
    5.70440821e-03 5.88116239e-03 6.0633934e-03 6.25127093e-03 6.44496994e-03 \
    6.64467083e-03 6.85055956e-03 7.06282786e-03 7.28167341e-03 7.50730000e-03 \
    7.73991776e-03 7.97974331e-03 8.22699998e-03 8.48191803e-03 8.74473486e-03 \
    9.01569521e-03 9.29505141e-03 9.58306362e-03 9.88000004e-03 1.01861372e-02 \
    1.05017602e-02 1.08271629e-02 1.11626484e-02 1.15085291e-02 1.18651271e-02 \
    1.22327745e-02 1.26118137e-02 1.30025976e-02 1.34054901e-02 1.38208665e-02 \
    1.42491135e-02 1.46906300e-02 1.51458271e-02 1.56151288e-02 1.60989720e-02 \
    1.65978074e-02 1.71120995e-02 1.76423271e-02 1.81889842e-02 1.87525797e-02 \
    1.93336386e-02 1.99327019e-02 2.05503274e-02 2.11870905e-02 2.18435839e-02 \
    2.25204192e-02 2.32182266e-02 2.3937656e-02 2.46793772e-02 2.54440811e-02 \
    2.62324797e-02 2.70453073e-02 2.78833208e-02 2.87473006e-02 2.96380513e-02 \
    3.05564024e-02 3.15032091e-02 3.24793531e-02 3.34857435e-02 3.45233174e-02 \
    3.55930411e-02 3.66959107e-02 3.78329534e-02 3.9005228e-02 4.02138261e-02 \
    4.14598733e-02 4.274453e-02 4.40689924e-02 4.5434494e-02 4.68423064e-02 \
    4.82937407e-02 4.97901484e-02 5.13329231e-02 5.29235016e-02 5.45633649e-02 \
    5.62540404e-02 5.79971023e-02 5.9794174e-02 6.16469288e-02 6.35570923e-02 \
    6.55264433e-02 6.75568156e-02 6.96501002e-02 7.18082463e-02 7.40332637e-02 \
    7.63272245e-02 7.86922649e-02 8.11305874e-02 8.36444626e-02 8.62362316e-02 \
    8.89083080e-02 9.16631801e-02 9.45034134e-02 9.74316529e-02 1.00450625e-01 \
    1.03563143e-01 1.06772103e-01 1.10080494e-01 1.13491398e-01 1.17007990e-01 \
    1.20633546e-01 1.24371442e-01 1.28225159e-01 1.32198285e-01 1.36294520e-01 \
    1.4051768e-01 1.44871696e-01 1.49360624e-01 1.53988644e-01 1.58760066e-01 \
    1.63679332e-01 1.68751025e-01 1.73979867e-01 1.79370728e-01 1.84928627e-01 \
    1.90658741e-01 1.96566405e-01 2.02657122e-01 2.08936562e-01 2.15410575e-01 \
    2.22085188e-01 2.28966618e-01 2.36061273e-01 2.4337576e-01 2.50916889e-01 \
    2.58691685e-01 2.66707387e-01 2.74971460e-01 2.834916e-01 2.92275741e-01 \
    3.01332063e-01 3.10669000e-01 3.20295248e-01 3.3021977e-01 3.40451808e-01 \
    3.51000892e-01 3.61876845e-01 3.73089795e-01 3.84650184e-01 3.96568779e-01 \
    4.08856677e-01 4.21525323e-01 4.34586514e-01 4.48052412e-01 4.61935559e-01 \
    4.76248883e-01 4.91005712e-01 5.06219791e-01 5.21905285e-01 5.38076803e-01 \
    5.54749405e-01 5.71938616e-01 5.89660443e-01 6.07931392e-01 6.26768476e-01 \
    6.46189236e-01 6.66211760e-01 6.86854693e-01 7.08137257e-01 7.30079274e-01 \
    7.52701176e-01 7.76024030e-01 8.00069555e-01 8.24860144e-01 8.50418883e-01 \
    8.76769572e-01 9.03936753e-01 9.31945723e-01 9.60822566e-01 9.90594174e-01 \
    1.02128827e+00 1.05293344e+00 1.08555916e+00 1.11919579e+00 1.15387468e+00 \
    1.18962811e+00 1.22648939e+00 1.26449283e+00 1.30367382e+00 1.34406886e+00 \
    1.38571556e+00 1.42865271e+00 1.47292029e+00 1.51855952e+00 1.56561291e+00 \
    1.61412428e+00 1.66413879e+00 1.71570303e+00 1.76886502e+00 1.82367426e+00 \
    1.8801818e+00 1.93844025e+00 1.99850387e+00 2.0604286e+00 2.1242721e+00 \
    2.19009382e+00 2.25795506e+00 2.32791902e+00 2.40005086e+00 2.47441773e+00 \
    2.55108891e+00 2.63013578e+00 2.71163196e+00 2.79565335e+00 2.88227818e+00 \
    2.97158713e+00 3.06366337e+00 3.15859264e+00 3.25646335e+00 3.35736663e+00 \
    3.46139645e+00 3.5686497e+00 3.67922624e+00 3.79322906e+00 3.91076432e+00 \
    4.03194147e+00 4.15687336e+00 4.28567634e+00 4.41847034e+00 4.55537904e+00 \
    4.69652993e+00 4.84205445e+00 4.99208813e+00 5.14677069e+00 5.30624617e+00 \
    5.47066308e+00 5.64017454e+00 5.81493841e+00 5.99511742e+00 6.18087939e+00 \
    6.37239728e+00 6.56984947e+00 6.77341981e+00 6.9832979e+00 7.19967917e+00 \
    7.42276513e+00 7.65276353e+00 7.88988855e+00 8.13436103e+00 8.38640861e+00 \
    8.64626603e+00 8.91417527e+00 9.19038582e+00 9.47515490e+00 9.76874771e+00 \
    1.00714377e+01 1.03835066e+01 1.07052452e+01 1.10369530e+01 1.1378939e+01 \
    1.17315216e+01 1.20950291e+01 1.24698002e+01 1.28561837e+01 1.32545395e+01 \
    1.36652386e+01 1.40886634e+01 1.45252083e+01 1.49752797e+01 1.54392969e+01 \
    1.59176919e+01 1.64109102e+01 1.69194111e+01 1.74436683e+01 1.79841698e+01 \
    1.85414190e+01 1.91159349e+01 1.97082525e+01 2.03189234e+01 2.09485163e+01 \
    2.15976174e+01 2.22668313e+01 2.29567811e+01 2.36681094e+01 2.44014786e+01 \
    2.51575717e+01 2.59370927e+01 2.67407675e+01 2.75693447e+01 2.84235958e+01 \
    2.93043163e+01 3.02123264e+01 3.11484717e+01 3.21136240e+01 3.31086821e+01 \
    3.41345725e+01 3.51922507e+01 3.62827017e+01 3.74069409e+01 3.85660152e+01 \
    3.97610041e+01 4.09930204e+01 4.22632113e+01 4.35727598e+01 4.49228854e+01 \
    4.63148453e+01 4.77499359e+01 4.92294936e+01 5.07548961e+01 5.23275641e+01 \
    5.39489620e+01 5.56205998e+01 5.73440343e+01 5.91208702e+01 6.09527624e+01 \
    6.28414168e+01 6.47885922e+01 6.67961018e+01 6.88658152e+01 7.09996598e+01 \
    7.31996228e+01 7.54677528e+01 7.7806162e+01 8.02170281e+01 8.27025962e+01 \
    8.52651809e+01 8.79071688e+01 9.06310200e+01 9.34392713e+01 9.63345378e+01 \
    9.93195156e+01 1.02396985e+02 1.05569811e+02 1.08840949e+02 1.12213444e+02 \
    1.15690439e+02 1.1927517e+02 1.22970975e+02 1.26781298e+02 1.30709685e+02 \
    1.34759795e+02 1.38935401e+02 1.43240389e+02 1.47678770e+02 1.52254677e+02 \
    1.56972371e+02 1.61836245e+02 1.66850829e+02 1.72020792e+02 1.77350949e+02 \
    1.82846265e+02 1.88511855e+02 1.94352997e+02 2.00375130e+02 2.06583862e+02 \
    2.12984975e+02 2.19584430e+02 2.26388373e+02 2.33403139e+02 2.40635262e+02 \
    2.48091476e+02 2.55778725e+02 2.63704167e+02 2.71875184e+02 2.80299383e+02 \
    2.88984612e+02 2.97938957e+02 3.07170757e+02 3.16688609e+02 3.26501377e+02 \
    3.36618199e+02 3.47048497e+02 3.57801982e+02 3.68888671e+02 3.80318886e+02 \
    3.92103273e+02 4.04252805e+02 4.16778798e+02 4.29692915e+02 4.43007182e+02 \
    4.56734e+02 4.70886151e+02 4.85476813e+02 5.00519575e+02 5.16028446e+02 \
    5.32017867e+02 5.48502729e+02 5.65498383e+02 5.83020657e+02 6.01085868e+02 
    1.
    3.75
  /
END

#=========================== chemistry ========================================
CHEMISTRY
  #LOG_FORMULATION
  TRUNCATE_CONCENTRATION 1e-30
  UPDATE_POROSITY
  UPDATE_PERMEABILITY
  PRIMARY_SPECIES
    H+
    SiO2(aq)
    Al+++
    Ca++
    Cl-
    CO2(aq)
    Na+
    K+
    Mg++
    Fe++
    SO4--
    Tracer
  /
  
  SECONDARY_SPECIES
    Al(OH)2+
    Al(OH)4-
    Al(OH)3(aq)
    AlOH++
    HCO3-
    CO3--
    CaCO3(aq)
    CaCl+
    CaCl2(aq)
    CaHCO3+
    CaSO4(aq)
    H2SiO4--
    H3SiO4-
    MgCO3(aq)
    MgHCO3+
    NaCO3-
    OH-
  /
  
  ACTIVE_GAS_SPECIES
    GAS_TRANSPORT_IS_UNVETTED
    CO2(g)
  /
  
  MINERALS
    Calcite
    Calcite_is
    SiO2(am)
    Quartz
    Kaolinite
  /
  
  MINERAL_KINETICS
  
    Kaolinite
      SURFACE_AREA_FUNCTION CONSTANT
      PREFACTOR
        RATE_CONSTANT -11.31 mol/m^2-sec     
        ACTIVATION_ENERGY 65.9
        PREFACTOR_SPECIES H+
          ALPHA 0.777                        
        /
      /
      PREFACTOR
        RATE_CONSTANT -13.18 mol/m^2-sec    
        ACTIVATION_ENERGY 22.2
      /
      PREFACTOR
        RATE_CONSTANT -17.05 mol/m^2-sec
        ACTIVATION_ENERGY 17.9
        PREFACTOR_SPECIES H+
          ALPHA -0.472
        /
      /
    /
    
    Quartz
      SURFACE_AREA_FUNCTION CONSTANT
      RATE_CONSTANT 0.0
    /
    
    Calcite
      SURFACE_AREA_FUNCTION VOLUME_FRACTION_RATIO
      SURFACE_AREA_VOL_FRAC_POWER 0.199701
      PREFACTOR
        RATE_CONSTANT -0.30 mol/m^2-sec
        ACTIVATION_ENERGY 14.4
        PREFACTOR_SPECIES H+
          ALPHA 1
        /
      /
      PREFACTOR
        RATE_CONSTANT -5.81 mol/m^2-sec     
        ACTIVATION_ENERGY 23.5
      /
    /
    
    Calcite_is
      SURFACE_AREA_FUNCTION VOLUME_FRACTION_RATIO
      SURFACE_AREA_VOL_FRAC_POWER 3.5
      PREFACTOR
        RATE_CONSTANT -0.30 mol/m^2-sec     
        ACTIVATION_ENERGY 14.4
        PREFACTOR_SPECIES H+
          ALPHA 1
        /
      /
      PREFACTOR
        RATE_CONSTANT -5.81 mol/m^2-sec
        ACTIVATION_ENERGY 23.5
      /     
    /

    SiO2(am)
      SURFACE_AREA_FUNCTION CONSTANT
      PREFACTOR
        RATE_CONSTANT -12.5 mol/m^2-sec
        ACTIVATION_ENERGY 74.5
        PREFACTOR_SPECIES H+
          ALPHA -0.51632703098                           
        /
      /
    /  
  /
  
  DATABASE ../hanford.dat
  #LOG_FORMULATION
  MOLAL
#  OPERATOR_SPLITTING
  ACTIVITY_COEFFICIENTS TIMESTEP
  OUTPUT
    PH
    H2SiO4--
    H3SiO4-
    CO2(g)
    HCO3-
    TOTAL
    ALL
    MINERAL_SURFACE_AREA
  /
END
 
#=========================== fluid properties =================================
FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9
END
 
#=========================== material properties ==============================
MATERIAL_PROPERTY soil1
  ID 1
  POROSITY DATASET por
  TORTUOSITY_FUNCTION_OF_POROSITY 1.
  PERMEABILITY
    PERM_X 1.d-12
    PERM_Y 1.d-12
    PERM_Z 1.d-13
  /
  THERMAL_CONDUCTIVITY_DRY 1.2d0 # not used
  THERMAL_CONDUCTIVITY_WET 1.2d0
  HEAT_CAPACITY 830.
  CHARACTERISTIC_CURVES matrix
  PERMEABILITY_CRITICAL_POROSITY 0.001
  PERMEABILITY_POWER 2.5
  PERMEABILITY_MIN_SCALE_FACTOR 1e-12
  ROCK_DENSITY 3e3
END
 
#=========================== characteristic curves ============================
CHARACTERISTIC_CURVES default
  DEFAULT
END
 
CHARACTERISTIC_CURVES matrix
  SATURATION_FUNCTION VAN_GENUCHTEN
    M 0.66d0
    ALPHA  1.02d-5
    LIQUID_RESIDUAL_SATURATION 0.1
  /
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
    M 0.66d0
    LIQUID_RESIDUAL_SATURATION 0.1
  /
/
 
#=========================== output options ===================================
OUTPUT
  PERIODIC TIME 100 h
  FORMAT VTK
  VARIABLES
     POROSITY
     PERMEABILITY
     LIQUID_PRESSURE
     TEMPERATURE
  END
  VELOCITY_AT_CENTER
END
 
#=========================== times ============================================
TIME
  FINAL_TIME 5.d0 y
  INITIAL_TIMESTEP_SIZE 0.1 h
  MAXIMUM_TIMESTEP_SIZE 100 h
END
 
#=========================== regions ==========================================
REGION all
  COORDINATES
    0.1d0 0.d0 0.d0
    20.d3 1.d0 300.0
  /
END

REGION base
  FACE bottom
  COORDINATES
    0.1d0 0.d0 0.d0
    20.d3 1.d0 0.d0
  /
END
 
REGION cap
  FACE top
  COORDINATES
    0.1d0 0.d0 300.0
    20.d3 1.d0 300.0
  /
END

REGION outer
  FACE east
  COORDINATES
    20.d3 0.0 0.0
    20.d3 1.0 300.0
  /
END

REGION feedzone
  FACE west
  COORDINATES
    0.1 0.0 100.0
    0.1 1.0 200.0
  /
END

#=========================== flow conditions ==================================
FLOW_CONDITION initial_pressure
  TYPE
    LIQUID_PRESSURE hydrostatic
    TEMPERATURE DIRICHLET
  /
  DATUM 0. 0. 0.
  LIQUID_PRESSURE 1.d7
  TEMPERATURE 250.
END
 
FLOW_CONDITION outer_pressure
  TYPE
    LIQUID_PRESSURE DIRICHLET
    #ENERGY_FLUX NEUMANN
    TEMPERATURE DIRICHLET
  /
  LIQUID_PRESSURE 1.d7 Pa
  #ENERGY_FLUX 0.0 W/m^2
  TEMPERATURE 250.
END

FLOW_CONDITION base_temp
  TYPE
    LIQUID_FLUX NEUMANN
    TEMPERATURE DIRICHLET
  /
  LIQUID_FLUX 0.
  TEMPERATURE 250.
END

FLOW_CONDITION cap_temp
  TYPE
    LIQUID_FLUX NEUMANN
    TEMPERATURE DIRICHLET
  /
  LIQUID_FLUX 0.
  TEMPERATURE 200.
END

FLOW_CONDITION well_pressure
  TYPE
    LIQUID_PRESSURE DIRICHLET
    TEMPERATURE DIRICHLET
  /
  LIQUID_PRESSURE 1.5d7
  TEMPERATURE 150.
END

FLOW_CONDITION well_flux
  TYPE
    RATE scaled_mass_rate PERM
    TEMPERATURE DIRICHLET
  /
  RATE 1. kg/sec
  TEMPERATURE 150. 
END
#=========================== transport conditions =============================
TRANSPORT_CONDITION background_conc
  TYPE ZERO_GRADIENT
  CONSTRAINT_LIST
    0.d0 initial_constraint
  /
END
 
TRANSPORT_CONDITION inlet_conc
  TYPE DIRICHLET_ZERO_GRADIENT
  TIME_UNITS d
  CONSTRAINT_LIST
    0.d0 inlet_constraint_1
  /
END
 
#=========================== constraints ======================================
CONSTRAINT initial_constraint
  CONCENTRATIONS
    H+              4.72          P
 
    Cl-          0.026398         Z
    SO4--        0.004397         T
    SiO2(aq)     0.014            T
    Ca++         7.008879e-5      T
    Fe++         1.257524e-6      T
    K+           0.002668         T
    Mg++         8.255675e-7      T
    Al+++        5.949386e-5      T
    Na+          0.031377         T
    CO2(aq)      0.1             T
 
    Tracer          1.d-30        T
  /
  MINERALS
 
    Calcite         DATASET calc 0.584059 cm^2/cm^3
    Calcite_is      0.00226853  0.145844 cm^2/cm^3
    SiO2(am)        0.0  7.12172e+03 cm^2/cm^3
    Quartz          DATASET qtz  1.0  cm^2/cm^3
    Kaolinite       0.0  7.73840e-03 cm^2/cm^3
 
  /
END
 
CONSTRAINT inlet_constraint_1
  CONCENTRATIONS 
    H+              4.72          P
 
    Cl-          0.026398         Z
    SO4--        0.004397         T
    SiO2(aq)     0.014            T
    Ca++         7.008879e-5      T
    Fe++         1.257524e-6      T
    K+           0.002668         T
    Mg++         8.255675e-7      T
    Al+++        5.949386e-5      T
    Na+          0.031377         T
    CO2(aq)      0.1             T
 
    Tracer          1.d-10        T
  /
END
 
#=========================== condition couplers ===============================

INITIAL_CONDITION
  FLOW_CONDITION initial_pressure
  TRANSPORT_CONDITION background_conc
  REGION all
END
 
BOUNDARY_CONDITION outlet
  FLOW_CONDITION initial_pressure
  TRANSPORT_CONDITION background_conc
  REGION outer
END

BOUNDARY_CONDITION inlet
  FLOW_CONDITION well_pressure
  TRANSPORT_CONDITION inlet_conc
  REGION feedzone
END

BOUNDARY_CONDITION base
  FLOW_CONDITION base_temp
  TRANSPORT_CONDITION background_conc
  REGION base
END

BOUNDARY_CONDITION cap
  FLOW_CONDITION cap_temp
  TRANSPORT_CONDITION background_conc
  REGION cap
END

#SOURCE_SINK inlet
#  FLOW_CONDITION well_flux
#  #FLOW_CONDITION inlet_pressure
#  TRANSPORT_CONDITION inlet_conc
#  REGION feedzone
#END

#=========================== datasets ============================

DATASET por
  FILENAME reservoir.h5
  HDF5_DATASET_NAME Porosity
END

DATASET qtz
  FILENAME reservoir.h5
  HDF5_DATASET_NAME Quartz_VF
END

DATASET calc
  FILENAME reservoir.h5
  HDF5_DATASET_NAME Calcite_VF
END

#=========================== stratigraphy couplers ============================
STRATA
  REGION all
  MATERIAL soil1
END
 
END_SUBSURFACE
 